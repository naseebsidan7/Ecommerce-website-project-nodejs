(()=>{var e={42:e=>{e.exports="28.0.23"}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window&&window._shoprunner_com,t=window&&window.sr_$,n={LANDING_PAGE:"landing",HOME_PAGE:"home",CATEGORY_PAGE:"category",PRODUCT_PAGE:"product",COLLECTION_PAGE:"collection",SEARCH_RESULTS_PAGE:"search results",BRAND_PAGE:"brand",ACCOUNT_PAGE:"account",CART_PAGE:"cart",CHECKOUT_PAGE:"checkout",ORDER_REVIEW_PAGE:"order review",ORDER_CONFIRMATION_PAGE:"order confirmation",STORE_LOCATION_PAGE:"store location",ERROR_PAGE:"error"};var a=r(42),i=r.n(a);function o(e){return e.length>150?`${e.slice(0,147)}...`:e}const c=r=>{if(2!==e.environmentID)return;let n=r;null==r?n=new Error("Unknown error"):r.stack||(n="[object RegExp]"===Object.prototype.toString.call(r)?new Error(r):"object"==typeof r?new Error(JSON.stringify(r)):new Error(r));const a={name:n.name,message:n.description||n.message,stack:n.stack,partnerId:e.retailerID,pageUrl:window.location.href};n.fileName&&(a.fileName=n.fileName,a.lineNumber=n.lineNumber,a.columnNumber=n.columnNumber),t.scriptSrc&&(a.scriptSrc=t.scriptSrc),window.navigator.userAgent&&(a.userAgent=window.navigator.userAgent);const i=JSON.stringify(a),o=`json=${encodeURIComponent(i)}`,c=new XMLHttpRequest;c.open("POST","https://logs-api.shoprunner.com/errors-pik.log",!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),c.timeout=3e3,c.send(o)},s=e=>"function"!=typeof e?e:function(...t){try{return e.apply(this,t)}catch(e){return console.error(e),void c(e)}},l="2"==_shoprunner_com.environmentID?"dp.shoprunner.com":"dp-staging.shoprunner.com",u="sr_snowplow";const g=function(e,t,r){if(e.sr_snowplow)return e.sr_snowplow;e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(u),e.sr_snowplow=function(){(e.sr_snowplow.q=e.sr_snowplow.q||[]).push(arguments)};const n=e.sr_snowplow;e.sr_snowplow.q=e.sr_snowplow.q||[];const a=t.createElement("script");a.async=1,a.src="//dp.shoprunner.com/2.9.0/sp.js";const i=t.getElementsByTagName("script")[0];return i&&i.parentNode&&i.parentNode.insertBefore(a,i),n("newTracker","cf",l,{appId:r,userFingerprint:!0,userFingerprintSeed:6385936734,pageUnloadTimer:0,stateStorageStrategy:"localStorage",cookieName:"_sr_sp_"}),n("setOptOutCookie","shoprunnerTrackingDisable"),n}(window,document,e.retailerID),d=new class{constructor(e,t,r){this.snowplow=e,this.pikContext=t,this.retailerId=r,this.pageUrl=window.location.href}commonContext(){return[{schema:"iglu:com.shoprunner.data/PIK/jsonschema/1-0-0",data:{build_id:this.pikContext.buildId,version_id:this.pikContext.versionId,session_id:this.pikContext.cookie.get("pik_session_id")}},{schema:"iglu:com.shoprunner.data/Experiment/jsonschema/1-0-0",data:{experiments:this.pikContext.track.getExperimentsArray()}},{schema:"iglu:com.shoprunner.data/MemberRef/jsonschema/1-0-0",data:{auth_token:this.pikContext.track.getAuthToken()||null}},{schema:"iglu:com.shoprunner.data/ShopperRef/jsonschema/1-0-0",data:{sr_browser_id:this.pikContext.cookie.get("browser_id")}},{schema:"iglu:com.shoprunner.data/PageRef/jsonschema/1-0-0",data:{page_url:o(this.pageUrl),page_type:this.pikContext.rmp.getPageType(),page_id:`${(new Date).getTime()+Math.floor(9e4*Math.random()+1e4)}`}},{schema:"iglu:com.shoprunner.data/RetailerRef/jsonschema/1-0-0",data:{retailer_code:this.retailerId}}]}sendEvent(e="GenericEvent",t={},r=[]){const n=this.commonContext().concat(r);this.snowplow("trackUnstructEvent",{schema:"iglu:com.shoprunner.data/"+e+"/jsonschema/1-0-0",data:t},n),function(e,t,r){"verbose"===window.sessionStorage.getItem("sr_qa")&&console.log("Snowplow Tracker\n\nEvent Type: "+e+"\n\nContext: "+JSON.stringify(t,null,2)+"\n\nData: "+JSON.stringify(r,null,2))}(e,n,t)}trackStructEvent(e){let t=void 0===e.contexts?this.commonContext():this.commonContext().concat(e.contexts);this.snowplow("trackStructEvent",e.category,e.action,e.label,e.property,e.value,t)}trackSimpleEvent(e,t,r=[]){this.trackStructEvent({category:e,action:t,contexts:r})}}(g,t,e.retailerID),{LANDING_PAGE:p,HOME_PAGE:m,CATEGORY_PAGE:h,PRODUCT_PAGE:_,COLLECTION_PAGE:w,SEARCH_RESULTS_PAGE:f,BRAND_PAGE:S,ACCOUNT_PAGE:k,CART_PAGE:P,CHECKOUT_PAGE:y,ORDER_REVIEW_PAGE:E,ORDER_CONFIRMATION_PAGE:v,STORE_LOCATION_PAGE:b,ERROR_PAGE:x}=n,T=e.retailerID||null;let A=null;t.pageAnalytics={version:i()},t.trackerSettings={click:"",change:"",addToCart:"",title:"",itemValue:"",itemOriginalValue:"",orderId:"",orderIdRegex:void 0,email:"",paymentType:"",shippingType:"",cartSubtotal:"",cartShipping:"",cartTax:"",cartDiscount:"",cartGiftCard:"",cartTotal:"",itemsInCartSelectors:[],itemsInCartText:"",pageLoading:"",useHashChangeEvent:!1,waitFor:!1,landingPage:void 0,homePage:void 0,accountPage:void 0,brandPage:void 0,categoryPage:void 0,collectionPage:void 0,searchPage:void 0,productPage:void 0,cartPage:void 0,shippingPage:void 0,paymentPage:void 0,checkoutPage:void 0,reviewPage:void 0,confirmationPage:void 0,locationPage:void 0,errorPage:void 0,eligible:void 0};const C=e=>e&&"number"==typeof e.length&&"object"==typeof e&&(e.length-1 in e||0===e.length),I=e=>{C(e)||(e=[e]);for(let r=0;r<e.length;r+=1){const n=e[r];let a;try{"string"==typeof n?t.jQ.fn?a=t.jQ(n).get(0):window.jQuery?a=window.jQuery(n).get(0):document.querySelectorAll&&([a]=document.querySelectorAll(n)):"function"==typeof n&&(a=n())}catch(e){a=null}if(a)return a}return null},R=e=>{let r;const n=[];try{if(t.jQ&&t.jQ.fn)return t.jQ(e);if(window.jQuery)return window.jQuery(e);if(!document.querySelectorAll)return n;r=document.querySelectorAll(e)}catch(e){console.error(e),r=[]}for(let e=0;e<r.length;e++)n.push(r[e]);return n},O=(e,t)=>{if(e){let r=e;if("string"==typeof e&&(r=R(e)),r.length){let e=t;t instanceof RegExp&&(e=e=>j(e,t));let n=0;for(let t=0;t<r.length;t++)n+=+e(r[t]);return n}}return null},D=e=>O(e,/(\d+)/),G=(e,t)=>{const r=R(e);for(let e=0;e<r.length;e+=1){const n=r[e].getAttribute(t);if(n)return n}return""},N=e=>null==e?"":`${e}`.trim(),L=e=>N((e||"").replace(/(\n+|\t+|\r+)/g," ").replace(/\s+/g," ")),j=(e,t)=>{let r="";if(e){if(C(e)){for(let n=0;n<e.length;n++)if(r=j(e[n],t),r)return L(r);return""}try{if("function"==typeof e)r=e(),"number"==typeof r&&(r=`${r}`);else if(e.tagName)r=e.innerText||e.textContent||e.value;else{const n=R(e);for(let e=0;e<n.length;e+=1)if(r=j(n[e],t),r)return L(r)}}catch(e){}if(r&&t&&t instanceof RegExp){const e=t.exec(r);r=e&&e[1]}}return L(r)},M=()=>{if("function"==typeof t.getSku){let e;try{e=t.getSku()}catch(e){}if(e)return N(e)}return null},U=()=>{if("function"==typeof t.getDocId){let e;try{e=t.getDocId()}catch(e){}if(e)return`${T}_${N(e)}`}return null},q=()=>{if(t.trackerSettings.title){const e=j(t.trackerSettings.title);if(e)return e;const r=I(t.trackerSettings.title);if(r&&"IMG"===r.tagName)return G(t.trackerSettings.title,"alt")}return null},V=()=>{let e=null;if(C(t.trackerSettings.itemValue))for(let r=0;r<t.trackerSettings.itemValue.length&&(e=$(t.trackerSettings.itemValue[r]),!e);r++);else t.trackerSettings.itemValue&&(e=$(t.trackerSettings.itemValue));return e?t.data.util.parseDecimal(e):null},H=()=>{let e=null;return t.trackerSettings.itemOriginalValue&&(e=$(t.trackerSettings.itemOriginalValue)),e?t.data.util.parseDecimal(e):null},$=e=>{const t=j(e);if(t.toLowerCase().indexOf("free")>=0)return"0";const r=/((\d,?)+(\.\d+)?)|(\.\d+)/.exec(t);return r?r[0].replace(/^((\d,?)*)(\.?)(\d*)$/,((e,t,r,n,a)=>(t.replace(",","")||"0")+(n||".")+(a&&(a.length>1?a.substring(0,2):`${a}0`)||"00"))):null},F=()=>{const e=$(t.trackerSettings.cartTotal);return e?t.data.util.parseDecimal(e):null},Q=()=>{if(t.trackerSettings.cartSubtotal){const e=$(t.trackerSettings.cartSubtotal);if(e)return t.data.util.parseDecimal(e)}return e.billingSubTotal?t.data.util.parseDecimal(e.billingSubTotal):e.cart&&e.cart.srSubTotal?t.data.util.parseDecimal(e.cart.srSubTotal):null},J=()=>{const e=$(t.trackerSettings.cartShipping);return e?t.data.util.parseDecimal(e):null},B=()=>{const e=$(t.trackerSettings.cartDiscount);return e?t.data.util.parseDecimal(e):null},K=()=>{const e=$(t.trackerSettings.cartGiftCard);return e?t.data.util.parseDecimal(e):null},Y=()=>{const e=$(t.trackerSettings.cartTax);return e?t.data.util.parseDecimal(e):null},W=()=>{let e,r="";const{itemsInCartText:n}=t.trackerSettings;if("CALLAPP"===T||"JCHOO"===T?(r=j(n),r=r.substring(0,r.indexOf(" ")).replace(/[^0-9]/g,"")):"LUCKY"===T?(window.csItems&&C(window.csItems)&&(r=window.csItems.join("|").replace("|nowrap","").split("|").length),!r&&window.utag_data&&(r=window.utag_data.cart_total_items)):"PELLIS"===T&&(r=j(n),r=r.substring(0,r.indexOf(" ")).replace(/[^0-9]/g,"")),!r&&n&&(r=j(n).replace(/[^0-9]/g,"")),!r&&"HBOSS"===T&&(r=0,window.dataLayer))for(var a=0;a<window.dataLayer.length;a++)if(window.dataLayer[a].basketProducts){const e=window.dataLayer[a].basketProducts;for(a=0;a<e.length;a++)r+=e[a].quantity;break}if(!r||"0"===r){const{itemsInCartSelectors:n}=t.trackerSettings;for(a=0;a<n.length;a++){const t=n[a].parent,i=n[a].child,o=n[a].quantity;I(t)&&(o?r=D(o)||0:(e=R(i),(!r||e.length>r)&&(r=e.length)))}}return r||"YUMIKIM"!==T?t.data.util.parseDecimal(r):R("#main-header .cart-wrapper .item .product-details").length},X=()=>{let r,n="";const a=window.location.href;return!n&&t.trackerSettings.orderId&&(n=j(t.trackerSettings.orderId)),!n&&t.trackerSettings.confirmationPage&&t.trackerSettings.orderIdRegex&&Z(t.trackerSettings.confirmationPage)&&(r=t.trackerSettings.orderIdRegex.exec(a),r&&(n=r[1])),n||e&&e.orderID&&"null"!==e.orderID&&(n=e.orderID),n||(n=window.google_conversion_order_id),n?N(n):null};function Z(e){if(e){if("string"==typeof e)return R(e).length>0;if("function"==typeof e)return!!e();if(e instanceof RegExp)return e.test(window.location.href);if(C(e))for(let t=0;t<e.length;t++)if(Z(e[t]))return!0}return!1}const z=()=>{let e="";return t.trackerSettings.shippingType&&(e=j(t.trackerSettings.shippingType)),e?N(e):null},ee=()=>{let e="";return t.trackerSettings.paymentType&&(e=j(t.trackerSettings.paymentType)),e?N(e):null},te=({excludedRetailers:e,excludedRetailerPages:t},r)=>{const n=!e.includes(T),a=!(t[T]&&t[T].some(Z));return document.getElementsByName(r).length>0&&n&&a},re=()=>A||(X()||Z(t.trackerSettings.confirmationPage)?v:Z(t.trackerSettings.reviewPage)?E:Z(t.trackerSettings.paymentPage)||Z(t.trackerSettings.shippingPage)||Z(t.trackerSettings.checkoutPage)?y:Z(t.trackerSettings.cartPage)||te({excludedRetailers:["MSTARS","STERLING","JJEANS","ATALIA","MROSE","HERVE","PEETS","RUZESHOES"],excludedRetailerPages:{}},"sr_headerDiv")?P:Z(t.trackerSettings.productPage)||te({excludedRetailers:["PEETS","FARMACY","SOLSTICE"],excludedRetailerPages:{}},"sr_productDetailDiv")?_:Z(t.trackerSettings.searchPage)?f:Z(t.trackerSettings.categoryPage)?h:Z(t.trackerSettings.collectionPage)?w:Z(t.trackerSettings.landingPage)?p:Z(t.trackerSettings.locationPage)?b:Z(t.trackerSettings.brandPage)?S:Z(t.trackerSettings.accountPage)?k:Z(t.trackerSettings.homePage)?m:Z(t.trackerSettings.errorPage)?x:null),ne=()=>{let e="";return"function"==typeof t.trackerSettings.email?e=t.trackerSettings.email():t.trackerSettings.email&&(e=j(t.trackerSettings.email)),e||re()!==v||window.utag_data&&(e=window.utag_data.customer_email),e?N(e):null},ae=function(){const r=t.cookie.get("token_copy");let n=t.cookie.get("token")||e.tokenID;return n=n?r||n:"",n},ie=()=>({items_in_cart:W(),cart_total:F(),cart_subtotal:Q(),cart_shipping:J(),cart_discount:B(),cart_gift_card:K(),cart_tax:Y()}),oe=()=>{const e={order_id:X(),order_email:ne(),payment_type:ee(),shipping_type:z()};return t.getPurchasedSkus&&(e.purchasedSkus=(()=>{if("function"==typeof t.getPurchasedSkus){let e;try{e=t.getPurchasedSkus()}catch(e){}if(e)return e}return null})()),t.getPurchasedDocIds&&(e.purchasedDocIds=(()=>{if("function"==typeof t.getPurchasedDocIds){let e;try{e=t.getPurchasedDocIds()}catch(e){}if(e)return e}return null})()),e},ce=()=>t.cookie.get("browser_id")||null;const se=()=>{let e={sr_browser_id:ce(),source:"external",retailer_code:T,page_id:le,page_type:re(),page_url:o(window.location.href),referrer:o(document.referrer),experiments:t.track.getExperiments()};switch(e.page_type){case _:e={...e,page_title:`${document.title}`||null,sku:M(),doc_id:U(),is_item_eligible:t.trackerSettings.eligible?Z(t.trackerSettings.eligible):Z('div[name="sr_productDetailDiv"]'),item_name:q(),item_price:V(),items_in_cart:W(),item_original_price:H()};break;case P:case y:case E:e={...e,...ie()};break;case v:e={...e,...oe()}}return d.sendEvent("PageViewEvent",e),e.page_type===_},le=`${(new Date).getTime()+Math.floor(9e4*Math.random()+1e4)}`;var ue;t.trackPage=function(e){const r=ae();if(t.trackerSettings.pageLoading&&I(t.trackerSettings.pageLoading)?setTimeout(s((()=>{t.trackPage(e)})),250):(e&&(window._sr_$_loaded=!1),"function"==typeof t.trackerSettings.waitFor&&t.trackerSettings.waitFor()?setTimeout(s((()=>{t.trackPage(e)})),1e3):se()),!r){var n=t.token.response;t.token.response=()=>{n.apply(this,arguments),t.member.signed_in&&se()}}},t.trackerSettings.useHashChangeEvent&&"onhashchange"in window&&window.addEventListener&&window.addEventListener("hashchange",s((()=>{t.trackPage(!0)})),!1),ue={homePage:["[rel='canonical'][href='https://us1-devbirds.myshopify.com/']","[rel='canonical'][href='https://www.allbirds.com/']"],accountPage:/\/account/,brandPage:/\/pages/,categoryPage:/\/collections/,productPage:/\/products/,checkoutPage:/checkouts/,shippingPage:/&step=shipping_method/,paymentPage:/&step=payment_method/,confirmationPage:/orders/,locationPage:/\/locations?/,errorPage:["._heading_11sv1_1.dd_heading_ly49w_25",".page-404"],searchPage:/\/search/,click:".jsx-1040726652.jsx-2758253766.SwatchList",change:".jsx-1040726652.jsx-2758253766.SwatchList",addToCart:"#add-to-cart",title:".PdpMasterProductDetails__heading.typography--secondary-heading",itemValue:".Paragraph.PdpMasterProductDetails__paragraph",itemOriginalValue:".Paragraph.PdpMasterProductDetails__compare-at-price",cartSubtotal:"[data-checkout-subtotal-price-target]",cartShipping:"[data-checkout-total-shipping-target]",cartTax:"[data-checkout-total-taxes-target]",cartTotal:[".payment-due__price.skeleton-while-loading--lg",".CartOrderSummary__value=Subtotal"],itemsInCartSelectors:[{parent:".CartLineItem__details-container",quantity:".jsx-570616337.NumberStepper"},{parent:".product",quantity:".product-thumbnail__quantity"}],itemsInCartText:".CartCount__icon-text",orderId:()=>j(".os-order-number",/([0-9]+$)/),email:".text-container > p > bdo",paymentType:".payment-method-list__item .payment-icon .visually-hidden",shippingType:".text-container > p:last-child",eligible:()=>"product"===re()&&!!document.querySelector('[name^="sr_productDetailDiv"]')},t.trackerSettings=Object.assign(t.trackerSettings,ue),t.getDocId=()=>G("select[data-productid]","data-productid")||window.meta.product.id,t.getSku=()=>window.meta.product.variants[0].id,t.trackPage(!0)})()})();
//# sourceMappingURL=pageAnalyticsALLBIRDS.js.map